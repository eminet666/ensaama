<html>

<head>
    <meta charset="utf-8">
    <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
    <script src="https://eminet666.github.io/ensaama/components/debug/debug.js"></script>
    <script src="./aframe-physics-system.min.js"></script>  
      
    <script>
        var masse = 0;
        AFRAME.registerComponent('masse', {
            dependencies: ['dynamic-body'],
            init: function () {
                var el = this.el;
                el.setAttribute('dynamic-body', 'mass : 0');
            },
            tick: function () {
                if(masse == 1){
                    var el = this.el;
                    var mass = el.getAttribute('dynamic-body').mass;
                    el.setAttribute('dynamic-body', 'mass : 1');
                }
            },           
        });

        AFRAME.registerComponent('gravity', {
            init: function () {
                var lefthand = document.getElementById('lefthand');
                lefthand.addEventListener("ybuttondown", function (event) {
                    console.log("evt: ybuttondown");
                    masse = 1;
                });

                window.addEventListener('keydown', function (event) {
                    if (event.key === 'y') {
                        console.log("evt: ykeydown");
                        masse = 1;
                    }
                });                
            },
        });        


    </script>
</head>

<body>
    <a-scene physics="debug: true" gravity debug-keyboard="key: g; event: ybuttondown; target: #lefthand">
        <!-- <a-entity id="plane" geometry="primitive: plane" material="color: #CCC" position="0 0 -5" rotation="-90 0 0"
            static-body></a-entity> -->

            <assets>
                <a-assets-idem id="obj-vache" src="assets/vache alien.obj" ></a-assets-idem>
                <a-assets-idem id="mtl-vache" src="assets/vache alien.mtl" ></a-assets-idem>
                <a-assets-idem id="obj-visage" src="assets/visage.obj" ></a-assets-idem>
                <a-assets-idem id="mtl-visage" src="assets/visage.mtl" ></a-assets-idem>

                <img id="sol" src="image/sol2.jpg">
                <img id="mur" src="image/mur.jpg">
                <img id="mur2" src="image/sol.jpg">
    
            </assets>
    
    
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="0 2.5 0" scale="0.5 0.5 0.5"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-3 2.5 0" scale="0.60 0.60 0.60"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="4 2.5 0" scale="0.25 0.25 0.25"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="0 80 0" scale="0.25 0.25 0.25"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-2 55 -2" scale="0.15 0.15 0.15"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-4 90 2" scale="0.25 0.25 0.25"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="1 45 -4" scale="0.35 0.35 0.35"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="3 45 1" scale="0.25 0.25 0.25"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-2 55 0" scale="0.55 0.55 0.55"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-1 40 3" scale="0.25 0.25 0.25"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="1 65 0" scale="0.75 0.75 0.75"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-2 85 -1" scale="0.55 0.55 0.55"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-3 75 -2" scale="0.85 0.85 0.85"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="1 95 0" scale="0.75 0.75 0.75"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="0 90 4" scale="0.25 0.25 0.25"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-2 80 0" scale="0.55 0.55 0.55"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-1 100 -4" scale="0.75 0.75 0.75"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="1 105 0" scale="0.75 0.75 0.75"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-3 110 1" scale="0.55 0.55 0.55"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-2 155 2" scale="1.5 1.5 1.5"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-1 120 -2" scale="1 1 1"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="4 20 1" scale="0.25 0.25 0.25"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="-3 35 2" scale="0.55 0.55 0.55"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="0 55 -3" scale="0.85 0.85 0.85"></a-entity>
          <a-entity dynamic-body masse obj-model="obj: #obj-vache; mtl: #mtl-vache" position="3 125 4" scale="0.75 0.75 0.75"></a-entity>

    
        <!-- Floor -->
        <a-plane static-body position="0 0 0" rotation="-90 0 0" width="10" height="10" material="src: #sol ; repeat : 1" side="double"></a-plane>
        <a-plane static-body position="0 3 -4" rotation="0 0 0" width="10" height="10" material="src: #mur ; repeat : 1" side="double"></a-plane>
        <a-plane static-body position="4.75 3 0" rotation="0 90 0" width="10" height="10" material="src: #mur ; repeat : 1" side="double"></a-plane>
        <a-plane static-body position="-4.75 3 0" rotation="0 90 0" width="10" height="10" material="src: #mur ; repeat : 1" side="double"></a-plane>
        <a-plane static-body position="0 3 5.25" rotation="0 0 0" width="10" height="10" material="src: #mur ; repeat : 1" side="double"></a-plane>
        <a-plane position="0 8 0" rotation="-90 0 0" width="10" height="10" material="src: #sol ; repeat : 1" side="double"></a-plane>
        <a-plane position="0 3 -4.5" rotation="0 0 0" width="8" height="8" material="src: #mur2 ; repeat : 1" side="double"scale="0.25 0.25 0.25"></a-plane>
        <a-sky ></a-sky>

        <!--Light-->
        <a-entity light="type: point; intensity: 1.75; distance: 100; decay: 2; color: red"
          position="0 15 0"></a-entity>


        <!-- PLAYER -->
        <a-entity id="player" position="0 0 0">
            <a-entity id="cam" camera position="0 1.6 4.5" look-controls wasd-controls="acceleration:10"
                begingame="xlimit: 0.2; zlimit: 0.2;" endgame="xlimit: 2; zlimit: 2;" currentposition="trace:false"
                chrono="trace: true">
                <a-text id="txtlog" value="" align="center" color="#FF0000" position="0 0 -1" rotation="0 0 0"
                    scale="0.25 0.25 0.25">
                </a-text>
            </a-entity>
            <a-entity id="lefthand" oculus-touch-controls="hand: left"></a-entity>
            <!-- <a-entity id="righthand" oculus-touch-controls="hand: right" droite></a-entity> -->
        </a-entity>


    </a-scene>
    
</body>

</html>